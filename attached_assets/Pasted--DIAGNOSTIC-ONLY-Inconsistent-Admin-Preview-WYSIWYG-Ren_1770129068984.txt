# DIAGNOSTIC ONLY ‚Äî Inconsistent Admin Preview / WYSIWYG Rendering (CCV Replit)

## Context (non-negotiable requirements)
The Admin experience for this project must be:
- A **real, embedded preview of the public website** inside Admin
- **Direct interaction on the preview** (click-to-edit texts, click-to-edit images)
- Same components as public site, with `adminPreview=1` enabling overlays/modals
- Admin route: `/admina` (password: 1909)
- No classic ‚Äúdetached dashboard-first CMS‚Äù workflow

## New critical evidence (IMPORTANT)
There is **clear proof that an interactive preview ALREADY EXISTS**:

- In **Admin ‚Üí Sezioni Pagine**, the Admin correctly shows:
  - A full live preview of the Home page
  - Real navigation header
  - Hero image
  - CTA
  - Page tabs (Home, Menu, Carta dei Vini, Cocktail Bar, etc.)
- This preview matches the expected WYSIWYG behavior and layout.

üëâ Therefore:
- The interactive preview system **is implemented**
- The issue is **NOT missing functionality**
- The issue is **inconsistent rendering / routing / layout composition across Admin sections**

## Current observed problem
- When entering `/admina`, the Admin shows a **Dashboard-only layout**
- Clicking sidebar items often keeps rendering the Dashboard
- The preview is **not consistently mounted across Admin routes**
- Some Admin sections show the preview correctly (e.g. Sezioni Pagine), others do not

## Goal of this step
**Analysis & diagnosis ONLY. No fixes.**

Produce a clear technical diagnosis explaining:
1) **Where** the Admin preview is implemented
2) **Why** it appears in some Admin sections but not others
3) **What architectural mismatch causes the Dashboard to persist**
4) Whether the issue is:
   - routing
   - layout nesting
   - missing outlet
   - conditional rendering
   - auth / guard redirect
   - duplicated Admin shells

---

## Required investigation (MANDATORY)

### A) Identify the Admin Preview implementation
1. Locate the exact component(s) responsible for rendering the live site preview
   - e.g. `AdminPreview`, `PreviewPane`, iframe, or reused public page components
2. Identify how `adminPreview=1` (or equivalent) is injected
3. Confirm which Admin route(s) currently mount this preview correctly

**Deliverable:** list of files + explanation of preview rendering flow.

---

### B) Admin routing & layout analysis
1. List all Admin routes (`/admina`, `/admina/*`)
2. For each route:
   - Which layout is used?
   - Does it include an `<Outlet />` or equivalent?
3. Verify whether:
   - Dashboard is acting as a catch-all
   - Nested routes are misconfigured
   - Preview routes are unreachable or shadowed

**Deliverable:** route ‚Üí layout ‚Üí rendered component table.

---

### C) Compare working vs non-working Admin sections
Specifically compare:
- **Sezioni Pagine (WORKING preview)**
- **Dashboard / other Admin sections (NO preview)**

Answer:
1. Do they use different layouts?
2. Do they mount different root components?
3. Is the preview conditionally rendered only in one section?

**Deliverable:** side-by-side architectural comparison.

---

### D) Public vs Admin component reuse
1. Confirm whether the Admin preview reuses:
   - the same public page components
   - or a separate iframe-based render
2. Confirm whether other Admin routes fail to reuse this mechanism

**Deliverable:** explanation of current component reuse strategy and where it breaks.

---

### E) Auth / redirect / guard side-effects
1. Verify if any auth or guard logic redirects Admin routes back to Dashboard
2. Check for silent redirects or conditional rendering
3. Note any console or network evidence

---

## Output (MANDATORY)
Create this diagnostic file:

`report/REPORT_ADMIN_PREVIEW_INCONSISTENCY.md`

It must include:
1) Confirmed facts (preview EXISTS)
2) Where preview works and where it does not
3) Root cause candidates (ranked, with evidence)
4) Why Dashboard persists instead of preview
5) Minimal next steps (PROPOSAL ONLY, no code)

Also add a short chat summary:
- ‚ÄúIs preview implemented?‚Äù ‚Üí YES
- ‚ÄúWhy not everywhere?‚Äù ‚Üí short technical explanation
- ‚ÄúNext verification step‚Äù ‚Üí 1 bullet

## Constraints
- NO refactors
- NO UI changes
- NO fixes
- Analysis and reporting ONLY

Proceed now.
